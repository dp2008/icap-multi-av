{% extends "base.html" %}

{% block title %}Dashboard - MetaScanner{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Dashboard</h1>
    <p class="page-subtitle">Ãœbersicht Ã¼ber Ihre Scan-AktivitÃ¤ten und Systemstatus</p>
</div>

<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-label">Gesamte Scans</div>
        <div class="stat-value">{{ stats.total_scans }}</div>
    </div>

    <div class="stat-card danger">
        <div class="stat-label">Bedrohungen erkannt</div>
        <div class="stat-value">{{ stats.threats_detected }}</div>
    </div>

    <div class="stat-card success">
        <div class="stat-label">Saubere Dateien</div>
        <div class="stat-value">{{ stats.clean_files }}</div>
    </div>

    <div class="stat-card warning">
        <div class="stat-label">Aktive Engines</div>
        <div class="stat-value">{{ stats.active_engines }}/{{ stats.total_engines }}</div>
    </div>
</div>

<div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px;">
    <div class="card">
        <h2 class="card-header">Aktuelle Scan-AktivitÃ¤ten</h2>
        {% if stats.recent_scans %}
            <table>
                <thead>
                    <tr>
                        <th>Dateiname</th>
                        <th>Zeitpunkt</th>
                        <th>Status</th>
                        <th>Aktionen</th>
                    </tr>
                </thead>
                <tbody>
                    {% for scan in stats.recent_scans %}
                    <tr>
                        <td>{{ scan.filename }}</td>
                        <td>{{ scan.timestamp }}</td>
                        <td>
                            {% if scan.threats_found %}
                                <span class="badge badge-danger">Bedrohung erkannt</span>
                            {% else %}
                                <span class="badge badge-success">Sauber</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{{ url_for('history_detail', scan_id=scan.id) }}" class="btn btn-primary" style="padding: 6px 12px; font-size: 12px;">Details</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <div class="empty-state">
                <div class="empty-state-icon">ğŸ“Š</div>
                <p>Noch keine Scans durchgefÃ¼hrt</p>
                <a href="{{ url_for('scan_file_page') }}" class="btn btn-primary" style="margin-top: 16px;">Ersten Scan starten</a>
            </div>
        {% endif %}
    </div>

    <div>
        <div class="card">
            <h2 class="card-header">Scan-Engines</h2>
            {% if engines %}
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    {% for engine, data in engines.items() %}
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #f9fafb; border-radius: 6px;">
                        <div>
                            <div style="font-weight: 600; color: #1f2937;">{{ engine|upper }}</div>
                            <div style="font-size: 12px; color: #6b7280;">
                                {% if data.active %}
                                    <span class="badge badge-success">Aktiv</span>
                                {% else %}
                                    <span class="badge badge-danger">Inaktiv</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <a href="{{ url_for('inventory') }}" class="btn btn-secondary" style="width: 100%; margin-top: 16px;">
                    Engines verwalten
                </a>
            {% else %}
                <div class="empty-state">
                    <p>Keine Engines verfÃ¼gbar</p>
                </div>
            {% endif %}
        </div>

        <div class="card" style="margin-top: 20px;">
            <h2 class="card-header">Schnellaktionen</h2>
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <a href="{{ url_for('scan_file_page') }}" class="btn btn-primary" style="width: 100%;">
                    ğŸ” Datei scannen
                </a>
                <a href="{{ url_for('history') }}" class="btn btn-secondary" style="width: 100%;">
                    ğŸ“‹ Scan-Verlauf anzeigen
                </a>
                <a href="{{ url_for('maintenance') }}" class="btn btn-secondary" style="width: 100%;">
                    ğŸ”§ Wartung
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
